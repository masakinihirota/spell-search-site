---

# AI指示書 簡潔版

## 1. 基本方針

* **言語**: 常に**日本語**を使用します。
* **タスク**: 一度に**一つのタスクのみ**実装します。

---

## 2. コーディング規約

* **TypeScript**: **型安全性**を最優先とします。
* **エラーハンドリング**: **必須**とします。
* **コメント/ドキュメント**: **日本語**で記述します。
* **コード品質**: **簡潔**、**正確**、**宣言的**（JSX）、**関数型/宣言型**を優先し、**ROROパターン**を活用します。
* **ファイルサイズ**: 1ファイル**500行以内**を目安とします。
* **コンポーネント**: **名前付きエクスポート**を使用します。

---

## 3. プロジェクト構造と命名

* **ディレクトリ/ファイル**: **ケバブケース** (`kebab-case`) を使用します。
* **Next.js App Router**: **コロケーション**（関連ファイルを同一ディレクトリに配置）を採用します。
* **データフェッチ**:
    * ページ全体: `page.tsx`/`layout.tsx`
    * コンポーネント固有: `Component.logic.tsx`
* **コンポーネント/型/インターフェース**: **パスカルケース** (`PascalCase`) を使用します。
* **変数/関数/メソッド**: **キャメルケース** (`camelCase`) を使用します。
* **定数**: **全て大文字+アンダースコア** (`ALL_CAPS`) を使用します。
* **状態変数**: **補助動詞＋説明的な名前** (`isLoading`など) を使用します。
* **DBテーブル/カラム (Supabase)**: **スネークケース** (`snake_case`) を使用し、テーブルは**複数形**とします。
* **DBテーブル/カラム (Drizzle ORM)**: コード上は**キャメルケース**、DB上は**スネークケース**とします。

---

## 4. UI/UX とアクセシビリティ

* **UI/UX**: **直感的**、**レスポンシブ**、**アニメーション/トランジション**を効果的に使用し、**タグ入力補完**を実装します。
* **アクセシビリティ**: **キーボード操作**、**適切なARIA属性**、**WCAG基準のコントラスト比**を確保します。

---

## 5. 技術スタックの活用

* **Next.js/React**: **最新バージョン**を使用し、**Server Components**を積極的に活用します。
* **Next.js サーバーアクション**: **積極的に使用**し、**Zodでバリデーション**、**適切なエラー処理**を行い、**戻り値をモデル化**します。
* **Supabase**: **型安全なクエリ**を使用し、**RLS**を実装します。
* **TypeScript**: **関数型プログラミング**、**インターフェース/型エイリアス**、**イミュータブルデータ**、**Optional Chaining/Nullish Coalescing**、**型推論と明示的型指定のバランス**、**any型回避**、**ユーティリティ型活用**を推奨します。
* **React**: **関数コンポーネントとフック**を使用し、**フックのルール遵守**、**コンポーネントの型付け**（`React.PropsWithChildren`推奨）、**責務分離**、**副作用管理**（`useEffect`）、**リストレンダリング時の`key`**を徹底します。

---

## 6. ドキュメンテーション

* **コメント**: **複雑なロジック**には**明確なコメント**を記述します。
* **TSDoc**: **エクスポートされる関数/コンポーネント**に**TSDoc形式のコメント**を記述します。
* **README**: **常に最新**に保ちます。
* **Supabase関連**: **スキーマ定義**、**RLSポリシー**、**Edge関数の設計ドキュメント**を作成します。

---

## 7. タスク管理

* **目的**: プロジェクト進捗の追跡、機能実装状況の把握。
* **作成**: 設計書からタスクを**分解**（半日〜1日目安）、**依存関係**、**目的**、**進捗確認**、**優先順位**、**完了基準**、**階層構造**、**要件参照**を明確にします。
* **構造**: `# 実装計画`で階層的に記述（例: `1. 大機能名 -> 1.1 小機能名`）。
* **場所**: メインは`vns-masakinihirota-design-task-list/tasks.md`、個別詳細は`_tasks/doing/[タスク名]/tasks.md`。
* **更新タイミング**: タスク完了、追加、進捗変更、優先順位/依存関係変更、細分化、要件/設計変更時。
* **ステータス**: `[ ]`未着手、`[~]`進行中、`[x]`完了、`[!]`問題あり/ブロック中。親タスクはサブタスクの状況に応じて更新します。
* **問題発生時**: `[!]`に変更し、`blocked/`フォルダに詳細レポートを記録します。
* **ドキュメント**: タスク完了後、`.copilot-document-instructions.md`に従い`document.md`に実装概要、設計、使い方などを記録します。
